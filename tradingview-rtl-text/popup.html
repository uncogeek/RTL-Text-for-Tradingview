<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    @font-face {
      font-family: 'Vazirmatn';
      src: url('Vazirmatn.ttf') format('truetype');
      font-weight: 100 900;
      font-style: normal;
    }
    
    body {
      width: 750px;
      height: 500px;
      padding: 0;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: #fafafa;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .toolbar {
      background: linear-gradient(to bottom, #ffffff 0%, #f8f8f8 100%);
      padding: 6px 10px;
      border-bottom: 1px solid #d0d0d0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      flex-shrink: 0;
    }
    
    .toolbar-row {
      display: flex;
      gap: 6px;
      align-items: center;
      margin-bottom: 5px;
    }
    
    .toolbar-row:last-child {
      margin-bottom: 0;
    }
    
    .toolbar-section {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 3px 6px;
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    }
    
    .toolbar-section.text-group {
      flex: 1;
    }
    
    .section-label {
      font-size: 9px;
      font-weight: 600;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-right: 3px;
    }
    
    .btn {
      padding: 3px 7px;
      border: 1px solid #d0d0d0;
      background: white;
      border-radius: 3px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 500;
      min-width: 24px;
      transition: all 0.2s;
      color: #333;
    }
    
    .btn:hover {
      background: #f5f5f5;
      border-color: #aaa;
    }
    
    .btn:active {
      background: #e8e8e8;
    }
    
    .btn.active {
      background: #4CAF50;
      color: white;
      border-color: #45a049;
    }
    
    .btn-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 28px;
      padding: 5px 7px;
    }
    
    .btn-icon svg {
      width: 14px;
      height: 14px;
    }
    
    .btn-recycle {
      background: #ff8181;
      color: white;
      border-color: #ff5252;
    }
    
    .btn-recycle:hover {
      background: #ff5252;
      border-color: #ff3838;
    }
    
    .btn-preview {
      background: #4a90e2;
      color: white;
      border-color: #3a7bc8;
    }
    
    .btn-preview:hover {
      background: #3a7bc8;
      border-color: #2a6bb8;
    }
    
    .btn-download {
      background: #4CAF50;
      color: white;
      border-color: #45a049;
    }
    
    .btn-download:hover {
      background: #45a049;
      border-color: #3d8b40;
    }
    
    .color-picker {
      width: 28px;
      height: 24px;
      border: 1px solid #d0d0d0;
      border-radius: 3px;
      cursor: pointer;
      padding: 2px;
      transition: border-color 0.2s;
    }
    
    .color-picker:hover {
      border-color: #999;
    }
    
    .number-control {
      display: flex;
      align-items: center;
      gap: 2px;
    }
    
    .number-display {
      min-width: 32px;
      text-align: center;
      font-size: 10px;
      font-weight: 600;
      padding: 2px 4px;
      border: 1px solid #e0e0e0;
      border-radius: 3px;
      background: #fafafa;
      color: #333;
    }
    
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .checkbox-group input[type="checkbox"] {
      cursor: pointer;
      width: 13px;
      height: 13px;
      accent-color: #4a90e2;
    }
    
    .checkbox-group label {
      font-size: 10px;
      font-weight: 500;
      cursor: pointer;
      color: #555;
      user-select: none;
    }
    
    .text-container {
      flex: 1;
      overflow: auto;
      background: white;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
      display: flex;
      justify-content: flex-end;
      align-items: flex-start;
    }
    
    #textInput {
      padding: 12px;
      font-size: 20px;
      direction: rtl;
      text-align: right;
      border: none;
      resize: none;
      outline: none;
      font-family: 'Vazirmatn', Arial, sans-serif;
      background: transparent;
      overflow-wrap: break-word;
      word-wrap: break-word;
      min-width: 100%;
      min-height: 100%;
    }
    
    .bottom-bar {
      background: linear-gradient(to bottom, #f8f8f8 0%, #ffffff 100%);
      padding: 8px 10px;
      border-top: 1px solid #d0d0d0;
      display: flex;
      gap: 6px;
      align-items: center;
      box-shadow: 0 -1px 3px rgba(0,0,0,0.05);
      flex-shrink: 0;
    }
    
    #insertBtn {
      flex: 1;
      padding: 8px 14px;
      background: #666;
      color: white;
      border: 1px solid #555;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    
    #insertBtn:hover {
      background: #555;
      border-color: #444;
    }
    
    #insertBtn:active {
      background: #444;
    }
    
    #insertBtn svg {
      width: 14px;
      height: 14px;
    }
    
    .shortcut-hint {
      font-size: 9px;
      color: #999;
      background: rgba(0,0,0,0.05);
      padding: 2px 4px;
      border-radius: 3px;
      font-weight: 500;
    }
    
    .slider-group {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .slider-group input[type="range"] {
      width: 60px;
      cursor: pointer;
      accent-color: #4a90e2;
    }
    
    .slider-group .value {
      font-size: 9px;
      min-width: 28px;
      text-align: center;
      font-weight: 600;
      color: #555;
    }
    
    .weight-slider-group {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .weight-slider-group input[type="range"] {
      width: 80px;
      cursor: pointer;
      accent-color: #4a90e2;
    }
    
    .weight-slider-group .value {
      font-size: 9px;
      min-width: 32px;
      text-align: center;
      font-weight: 600;
      color: #555;
    }
    
    .divider {
      width: 1px;
      height: 20px;
      background: #e0e0e0;
      margin: 0 2px;
    }

    .wrap-control {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .wrap-control.disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    
    /* Toast Notification */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      color: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 10000;
      opacity: 0;
      transform: translateX(400px);
      transition: all 0.3s ease;
      pointer-events: none;
      display: flex;
      align-items: center;
      gap: 8px;
      max-width: 300px;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }
    
    .toast.success {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
    }
    
    .toast.error {
      background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
    }
    
    .toast svg {
      width: 18px;
      height: 18px;
      flex-shrink: 0;
    }
    
    /* Preview Modal */
    .preview-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }
    
    .preview-modal.active {
      display: flex;
    }
    
    .preview-content {
      background: #808080;
      border-radius: 8px;
      padding: 20px;
      max-width: 90%;
      max-height: 90%;
      overflow: auto;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 10px;
      border-bottom: 2px solid #666;
    }
    
    .preview-title {
      font-size: 14px;
      font-weight: 600;
      color: white;
    }
    
    .preview-close {
      background: #ff5252;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      transition: all 0.2s;
    }
    
    .preview-close:hover {
      background: #ff3838;
    }
    
    .preview-image-container {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 200px;
    }
    
    .preview-image {
      max-width: 100%;
      max-height: 600px;
      border: 2px solid #555;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <!-- First Row: Text Styling -->
    <div class="toolbar-row">
      <div class="toolbar-section text-group">
        <span class="section-label">Weight</span>
        <div class="weight-slider-group">
          <input type="range" id="fontWeight" min="100" max="900" value="400" step="100" title="Font Weight">
          <span class="value" id="fontWeightValue">400</span>
        </div>
        <div class="divider"></div>
        <span class="section-label">Size</span>
        <div class="number-control">
          <button class="btn" id="fontSizeDec">-</button>
          <span class="number-display" id="fontSizeDisplay">20</span>
          <button class="btn" id="fontSizeInc">+</button>
        </div>
        <div class="divider"></div>
        <input type="color" class="color-picker" id="textColor" value="#000000" title="Text Color">
      </div>
      
      <div class="toolbar-section">
        <span class="section-label">Line</span>
        <div class="number-control">
          <button class="btn" id="lineHeightDec">-</button>
          <span class="number-display" id="lineHeightDisplay">1.5</span>
          <button class="btn" id="lineHeightInc">+</button>
        </div>
      </div>
    </div>
    
    <!-- Second Row: Background & Border -->
    <div class="toolbar-row">
      <div class="toolbar-section">
        <span class="section-label">BG</span>
        <input type="color" class="color-picker" id="bgColor" value="#ffffff" title="BG Color">
        <div class="divider"></div>
        <div class="slider-group">
          <input type="range" id="bgOpacity" min="0" max="100" value="100" title="Opacity">
          <span class="value" id="bgOpacityValue">100%</span>
        </div>
        <div class="divider"></div>
        <div class="checkbox-group">
          <input type="checkbox" id="fillBg" checked>
          <label for="fillBg">Fill</label>
        </div>
      </div>
      
      <div class="toolbar-section">
        <span class="section-label">Border</span>
        <div class="checkbox-group">
          <input type="checkbox" id="showBorder">
          <label for="showBorder">Show</label>
        </div>
        <div class="divider"></div>
        <input type="color" class="color-picker" id="borderColor" value="#000000" title="Border Color">
        <div class="divider"></div>
        <div class="number-control">
          <button class="btn" id="borderWidthDec">-</button>
          <span class="number-display" id="borderWidthDisplay">2</span>
          <button class="btn" id="borderWidthInc">+</button>
        </div>
      </div>
      
      <div class="toolbar-section">
        <span class="section-label">Pad</span>
        <div class="number-control">
          <button class="btn" id="paddingDec">-</button>
          <span class="number-display" id="paddingDisplay">20</span>
          <button class="btn" id="paddingInc">+</button>
        </div>
      </div>
    </div>

    <!-- Third Row: Text Wrapping -->
    <div class="toolbar-row">
      <div class="toolbar-section" style="flex: 1;">
        <span class="section-label">Wrap</span>
        <div class="checkbox-group">
          <input type="checkbox" id="wrapText">
          <label for="wrapText">Enable</label>
        </div>
        <div class="divider"></div>
        <div class="wrap-control" id="wrapControl">
          <span class="section-label" style="margin-right: 0;">Max Width</span>
          <div class="slider-group">
            <input type="range" id="maxWidth" min="200" max="2000" value="800" step="50" title="Max Width">
            <span class="value" id="maxWidthValue">800px</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="text-container">
    <textarea id="textInput" placeholder="Type your RTL text here..."></textarea>
  </div>
  
  <div class="bottom-bar">
    <button id="insertBtn">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
        <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
      </svg>
      <span>Create & Copy Image</span>
      <span class="shortcut-hint">Ctrl+Enter</span>
    </button>
    
    <button class="btn btn-icon btn-download" id="downloadBtn" title="Download Image">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
      </svg>
    </button>
    
    <button class="btn btn-icon btn-recycle" id="recycleBtn" title="Clear Text">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"/>
      </svg>
    </button>
    
    <button class="btn btn-icon btn-preview" id="previewBtn" title="Preview Image">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
        <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
        <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
      </svg>
    </button>
  </div>
  
  <canvas id="canvas" style="display:none;"></canvas>
  
  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
    </svg>
    <span id="toastMessage"></span>
  </div>
  
  <!-- Preview Modal -->
  <div class="preview-modal" id="previewModal">
    <div class="preview-content">
      <div class="preview-header">
        <span class="preview-title">Image Preview</span>
        <button class="preview-close" id="closePreview">Close (ESC)</button>
      </div>
      <div class="preview-image-container">
        <img id="previewImage" class="preview-image" alt="Preview">
      </div>
    </div>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>